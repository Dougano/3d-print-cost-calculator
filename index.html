<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#2563eb">
    <meta name="description" content="3D Printing Business Cost Calculator for South Africa">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="PrintCalc">
    <title>3D Print Cost Calculator</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide React icons as simple SVGs
        const Calculator = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="4" y="2" width="16" height="20" rx="2"/>
                <line x1="8" y1="6" x2="16" y2="6"/>
                <line x1="16" y1="10" x2="16" y2="10"/>
                <line x1="12" y1="10" x2="12" y2="10"/>
                <line x1="8" y1="10" x2="8" y2="10"/>
                <line x1="16" y1="14" x2="16" y2="14"/>
                <line x1="12" y1="14" x2="12" y2="14"/>
                <line x1="8" y1="14" x2="8" y2="14"/>
                <line x1="16" y1="18" x2="16" y2="18"/>
                <line x1="12" y1="18" x2="12" y2="18"/>
                <line x1="8" y1="18" x2="8" y2="18"/>
            </svg>
        );

        const Package = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="m7.5 4.27 9 5.15"/>
                <path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/>
                <path d="m3.3 7 8.7 5 8.7-5"/>
                <path d="M12 22V12"/>
            </svg>
        );

        const DollarSign = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
        );

        const Save = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17,21 17,13 7,13 7,21"/>
                <polyline points="7,3 7,8 15,8"/>
            </svg>
        );

        const Smartphone = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="5" y="2" width="14" height="20" rx="2" ry="2"/>
                <line x1="12" y1="18" x2="12.01" y2="18"/>
            </svg>
        );

        const filamentTypes = {
            ABS: { name: 'Acrylonitrile Butadiene Styrene', density: 1.05 },
            PLA: { name: 'Polylactic Acid', density: 1.27 },
            PETG: { name: 'Polyethylene Terephthalate', density: 1.25 },
            PETT: { name: 'T-Glase filament', density: 1.45 },
            HIPS: { name: 'High Impact Polystyrene', density: 1.04 },
            TPU: { name: 'Thermoplastic Polyurethane', density: 1.30 },
            CUSTOM: { name: 'Custom Material', density: 1.20 }
        };

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#2563eb">
    <meta name="description" content="3D Printing Business Cost Calculator for South Africa">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="PrintCalc">
    <title>3D Print Cost Calculator</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide React icons as simple SVGs
        const Calculator = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="4" y="2" width="16" height="20" rx="2"/>
                <line x1="8" y1="6" x2="16" y2="6"/>
                <line x1="16" y1="10" x2="16" y2="10"/>
                <line x1="12" y1="10" x2="12" y2="10"/>
                <line x1="8" y1="10" x2="8" y2="10"/>
                <line x1="16" y1="14" x2="16" y2="14"/>
                <line x1="12" y1="14" x2="12" y2="14"/>
                <line x1="8" y1="14" x2="8" y2="14"/>
                <line x1="16" y1="18" x2="16" y2="18"/>
                <line x1="12" y1="18" x2="12" y2="18"/>
                <line x1="8" y1="18" x2="8" y2="18"/>
            </svg>
        );

        const Package = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="m7.5 4.27 9 5.15"/>
                <path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/>
                <path d="m3.3 7 8.7 5 8.7-5"/>
                <path d="M12 22V12"/>
            </svg>
        );

        const DollarSign = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
        );

        const Save = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17,21 17,13 7,13 7,21"/>
                <polyline points="7,3 7,8 15,8"/>
            </svg>
        );

        const Smartphone = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="5" y="2" width="14" height="20" rx="2" ry="2"/>
                <line x1="12" y1="18" x2="12.01" y2="18"/>
            </svg>
        );

        const filamentTypes = {
            ABS: { name: 'Acrylonitrile Butadiene Styrene', density: 1.05 },
            PLA: { name: 'Polylactic Acid', density: 1.27 },
            PETG: { name: 'Polyethylene Terephthalate', density: 1.25 },
            PETT: { name: 'T-Glase filament', density: 1.45 },
            HIPS: { name: 'High Impact Polystyrene', density: 1.04 },
            TPU: { name: 'Thermoplastic Polyurethane', density: 1.30 },
            CUSTOM: { name: 'Custom Material', density: 1.20 }
        };

        const CostCalculator = () => {
            // PWA installation state
            const [deferredPrompt, setDeferredPrompt] = useState(null);
            const [showInstallButton, setShowInstallButton] = useState(false);

            // Calculator state with South African defaults
            const [filamentType, setFilamentType] = useState('PLA');
            const [customDensity, setCustomDensity] = useState(1.20);
            const [filamentDiameter, setFilamentDiameter] = useState(1.75);
            const [filamentLength, setFilamentLength] = useState(10);
            const [filamentPrice, setFilamentPrice] = useState(450);
            const [filamentWeight, setFilamentWeight] = useState(1);
            const [printTime, setPrintTime] = useState(2);
            const [hourlyRate, setHourlyRate] = useState(250);
            const [markup, setMarkup] = useState(50);
            
            // 3D Printer operational costs (South African rates)
            const [printerPower, setPrinterPower] = useState(250);
            const [electricityRate, setElectricityRate] = useState(3.50);
            const [maintenanceCostPerHour, setMaintenanceCostPerHour] = useState(8.50);
            
            // Product management
            const [products, setProducts] = useState([]);
            const [productName, setProductName] = useState('');
            const [editingProduct, setEditingProduct] = useState(null);
            const [showMobileMenu, setShowMobileMenu] = useState(false);

            // Manual cost overrides
            const [manualOverrides, setManualOverrides] = useState({
                materialCost: null,
                laborCost: null,
                operationalCost: null,
                subtotal: null,
                profit: null,
                finalPrice: null
            });
            const [editingCost, setEditingCost] = useState(null);

            // PWA Setup
            useEffect(() => {
                try {
                    if (window.matchMedia && window.matchMedia('(display-mode: standalone)').matches) {
                        console.log('App is running in standalone mode');
                    }

                    const handleBeforeInstallPrompt = (e) => {
                        e.preventDefault();
                        setDeferredPrompt(e);
                        setShowInstallButton(true);
                    };

                    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

                    if ('serviceWorker' in navigator) {
                        const swScript = `
                            const CACHE_NAME = '3d-print-calc-v1';
                            
                            self.addEventListener('install', (event) => {
                                console.log('Service Worker installing');
                                self.skipWaiting();
                            });

                            self.addEventListener('activate', (event) => {
                                console.log('Service Worker activated');
                                event.waitUntil(self.clients.claim());
                            });

                            self.addEventListener('fetch', (event) => {
                                if (event.request.method === 'GET') {
                                    event.respondWith(
                                        caches.match(event.request)
                                            .then((response) => {
                                                if (response) {
                                                    return response;
                                                }
                                                return fetch(event.request).catch(() => {
                                                    if (event.request.mode === 'navigate') {
                                                        return new Response('<h1>App works offline</h1><p>Your 3D Print Calculator is available offline!</p>', {
                                                            headers: { 'Content-Type': 'text/html' }
                                                        });
                                                    }
                                                });
                                            })
                                    );
                                }
                            });
                        `;

                        const blob = new Blob([swScript], { type: 'application/javascript' });
                        const swUrl = URL.createObjectURL(blob);
                        
                        navigator.serviceWorker.register(swUrl)
                            .then((registration) => {
                                console.log('ServiceWorker registration successful');
                            })
                            .catch((error) => {
                                console.log('ServiceWorker registration failed:', error);
                            });
                    }

                    return () => {
                        window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
                    };
                } catch (error) {
                    console.log('PWA setup error:', error);
                }
            }, []);

            // Load products from localStorage with error handling
            useEffect(() => {
                try {
                    const savedProducts = localStorage?.getItem('3d_printing_products');
                    if (savedProducts && savedProducts !== 'null') {
                        const parsedProducts = JSON.parse(savedProducts);
                        if (Array.isArray(parsedProducts)) {
                            setProducts(parsedProducts);
                        }
                    }
                } catch (error) {
                    console.log('Error loading products:', error);
                    setProducts([]);
                }
            }, []);

            // Save products to localStorage with error handling
            useEffect(() => {
                try {
                    if (typeof Storage !== 'undefined' && localStorage) {
                        localStorage.setItem('3d_printing_products', JSON.stringify(products));
                    }
                } catch (error) {
                    console.log('Error saving products:', error);
                }
            }, [products]);

            // PWA Install function
            const handleInstallClick = async () => {
                if (deferredPrompt) {
                    try {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;
                        console.log(`User response to the install prompt: ${outcome}`);
                        setDeferredPrompt(null);
                        setShowInstallButton(false);
                    } catch (error) {
                        console.log('Install prompt error:', error);
                        setShowInstallButton(false);
                    }
                }
            };

            // Calculate costs with error handling
            const getCurrentDensity = () => {
                try {
                    return filamentType === 'CUSTOM' ? customDensity : filamentTypes[filamentType]?.density || 1.20;
                } catch (error) {
                    console.log('Error getting density:', error);
                    return 1.20;
                }
            };

            const calculateVolume = () => {
                try {
                    const radius = (filamentDiameter || 1.75) / 2;
                    const length = filamentLength || 0;
                    return Math.PI * Math.pow(radius, 2) * length / 1000;
                } catch (error) {
                    console.log('Error calculating volume:', error);
                    return 0;
                }
            };

            const calculateMaterialCost = () => {
                try {
                    if (manualOverrides.materialCost !== null) return manualOverrides.materialCost;
                    const density = getCurrentDensity();
                    const volume = calculateVolume();
                    const mass = (volume * density) / 1000;
                    const pricePerKg = (filamentPrice || 0) / (filamentWeight || 1);
                    return mass * pricePerKg;
                } catch (error) {
                    console.log('Error calculating material cost:', error);
                    return 0;
                }
            };

            const calculatePowerCost = () => {
                try {
                    const powerConsumptionKwh = ((printerPower || 0) / 1000) * (printTime || 0);
                    return powerConsumptionKwh * (electricityRate || 0);
                } catch (error) {
                    console.log('Error calculating power cost:', error);
                    return 0;
                }
            };

            const calculateMaintenanceCost = () => {
                try {
                    return (printTime || 0) * (maintenanceCostPerHour || 0);
                } catch (error) {
                    console.log('Error calculating maintenance cost:', error);
                    return 0;
                }
            };

            const calculateLaborCost = () => {
                try {
                    if (manualOverrides.laborCost !== null) return manualOverrides.laborCost;
                    return (printTime || 0) * (hourlyRate || 0);
                } catch (error) {
                    console.log('Error calculating labor cost:', error);
                    return 0;
                }
            };

            const calculateTotalOperationalCost = () => {
                try {
                    if (manualOverrides.operationalCost !== null) return manualOverrides.operationalCost;
                    return calculatePowerCost() + calculateMaintenanceCost();
                } catch (error) {
                    console.log('Error calculating operational cost:', error);
                    return 0;
                }
            };

            const calculateSubtotal = () => {
                try {
                    if (manualOverrides.subtotal !== null) return manualOverrides.subtotal;
                    return calculateMaterialCost() + calculateLaborCost() + calculateTotalOperationalCost();
                } catch (error) {
                    console.log('Error calculating subtotal:', error);
                    return 0;
                }
            };

            const calculateFinalPrice = () => {
                try {
                    if (manualOverrides.finalPrice !== null) return manualOverrides.finalPrice;
                    const subtotal = calculateSubtotal();
                    return subtotal * (1 + (markup || 0) / 100);
                } catch (error) {
                    console.log('Error calculating final price:', error);
                    return 0;
                }
            };

            const calculateProfit = () => {
                try {
                    if (manualOverrides.profit !== null) return manualOverrides.profit;
                    return calculateFinalPrice() - calculateSubtotal();
                } catch (error) {
                    console.log('Error calculating profit:', error);
                    return 0;
                }
            };

            // Manual cost editing functions
            const handleCostEdit = (costType, value) => {
                const numValue = parseFloat(value);
                setManualOverrides(prev => ({
                    ...prev,
                    [costType]: isNaN(numValue) ? null : numValue
                }));
            };

            const resetCostOverride = (costType) => {
                setManualOverrides(prev => ({
                    ...prev,
                    [costType]: null
                }));
                setEditingCost(null);
            };

            const resetAllOverrides = () => {
                setManualOverrides({
                    materialCost: null,
                    laborCost: null,
                    operationalCost: null,
                    subtotal: null,
                    profit: null,
                    finalPrice: null
                });
                setEditingCost(null);
            };

            // Product management functions with error handling
            const saveProduct = () => {
                try {
                    if (!productName.trim()) return;

                    const productData = {
                        id: editingProduct ? editingProduct.id : Date.now(),
                        name: productName,
                        filamentType,
                        customDensity,
                        filamentDiameter,
                        filamentLength,
                        filamentPrice,
                        filamentWeight,
                        printTime,
                        hourlyRate,
                        markup,
                        printerPower,
                        electricityRate,
                        maintenanceCostPerHour,
                        materialCost: calculateMaterialCost(),
                        laborCost: calculateLaborCost(),
                        operationalCost: calculateTotalOperationalCost(),
                        finalPrice: calculateFinalPrice(),
                        profit: calculateProfit(),
                        createdAt: editingProduct ? editingProduct.createdAt : new Date().toISOString()
                    };

                    if (editingProduct) {
                        setProducts(products.map(p => p.id === editingProduct.id ? productData : p));
                        setEditingProduct(null);
                    } else {
                        setProducts([...products, productData]);
                    }

                    setProductName('');
                    setShowMobileMenu(false);
                } catch (error) {
                    console.log('Error saving product:', error);
                    alert('Error saving product. Please try again.');
                }
            };

            const editProduct = (product) => {
                try {
                    if (!product) return;
                    
                    setEditingProduct(product);
                    setProductName(product.name || '');
                    setFilamentType(product.filamentType || 'PLA');
                    setCustomDensity(product.customDensity || 1.20);
                    setFilamentDiameter(product.filamentDiameter || 1.75);
                    setFilamentLength(product.filamentLength || 10);
                    setFilamentPrice(product.filamentPrice || 450);
                    setFilamentWeight(product.filamentWeight || 1);
                    setPrintTime(product.printTime || 2);
                    setHourlyRate(product.hourlyRate || 250);
                    setMarkup(product.markup || 50);
                    setPrinterPower(product.printerPower || 250);
                    setElectricityRate(product.electricityRate || 3.50);
                    setMaintenanceCostPerHour(product.maintenanceCostPerHour || 8.50);
                    setShowMobileMenu(false);
                } catch (error) {
                    console.log('Error editing product:', error);
                    alert('Error loading product. Please try again.');
                }
            };

            const deleteProduct = (id) => {
                try {
                    if (id && confirm('Are you sure you want to delete this product?')) {
                        setProducts(products.filter(p => p.id !== id));
                    }
                } catch (error) {
                    console.log('Error deleting product:', error);
                    alert('Error deleting product. Please try again.');
                }
            };

            const clearCalculator = () => {
                setEditingProduct(null);
                setProductName('');
                setFilamentType('PLA');
                setCustomDensity(1.20);
                setFilamentDiameter(1.75);
                setFilamentLength(10);
                setFilamentPrice(450);
                setFilamentWeight(1);
                setPrintTime(2);
                setHourlyRate(250);
                setMarkup(50);
                setPrinterPower(250);
                setElectricityRate(3.50);
                setMaintenanceCostPerHour(8.50);
                resetAllOverrides();
            };

            return React.createElement('div', { className: "max-w-7xl mx-auto p-2 md:p-6 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen" },
                // PWA Install Banner
                showInstallButton && React.createElement('div', { className: "bg-blue-600 text-white p-4 rounded-lg mb-4 flex items-center justify-between" },
                    React.createElement('div', { className: "flex items-center gap-3" },
                        React.createElement(Smartphone),
                        React.createElement('div', null,
                            React.createElement('h3', { className: "font-semibold" }, "Install App"),
                            React.createElement('p', { className: "text-sm opacity-90" }, "Add to home screen for quick access")
                        )
                    ),
                    React.createElement('button', {
                        onClick: handleInstallClick,
                        className: "bg-white text-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100"
                    }, "Install")
                ),

                // Header
                React.createElement('div', { className: "mb-6 text-center" },
                    React.createElement('h1', { className: "text-2xl md:text-4xl font-bold text-gray-800 mb-2 flex items-center justify-center gap-3" },
                        React.createElement(Calculator, { className: "text-blue-600" }),
                        "3D Print Calculator"
                    ),
                    React.createElement('p', { className: "text-gray-600 text-sm md:text-base" }, "Calculate costs and manage your 3D printing business")
                ),

                // Mobile Layout
                React.createElement('div', { className: "block lg:hidden" },
                    // Mobile Navigation
                    React.createElement('div', { className: "bg-white rounded-lg shadow-lg mb-4" },
                        React.createElement('div', { className: "flex border-b" },
                            React.createElement('button', {
                                onClick: () => setShowMobileMenu(false),
                                className: `flex-1 py-3 px-4 text-center font-medium ${!showMobileMenu ? 'bg-blue-600 text-white' : 'text-gray-600'}`
                            }, "Calculator"),
                            React.createElement('button', {
                                onClick: () => setShowMobileMenu(true),
                                className: `flex-1 py-3 px-4 text-center font-medium ${showMobileMenu ? 'bg-blue-600 text-white' : 'text-gray-600'}`
                            }, `Products (${products.length})`)
                        )
                    ),

                    !showMobileMenu ? 
                        // Mobile Calculator View
                        React.createElement('div', { className: "space-y-4" },
                            // Cost Breakdown - Mobile First
                            React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-4" },
                                React.createElement('h2', { className: "text-xl font-semibold mb-4 text-gray-800 flex items-center gap-2" },
                                    React.createElement(DollarSign, { className: "text-green-600" }),
                                    "Cost Breakdown"
                                ),

                                React.createElement('div', { className: "grid grid-cols-2 gap-3 text-sm" },
                                    React.createElement('div', { className: "bg-blue-50 rounded-lg p-3" },
                                        React.createElement('h3', { className: "font-semibold text-blue-800 mb-1 flex items-center justify-between" },
                                            "Material",
                                            manualOverrides.materialCost !== null && React.createElement('button', {
                                                onClick: () => resetCostOverride('materialCost'),
                                                className: "text-xs text-red-600 hover:text-red-800"
                                            }, "Reset")
                                        ),
                                        editingCost === 'materialCost' ? 
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.01",
                                                defaultValue: calculateMaterialCost().toFixed(2),
                                                onBlur: (e) => {
                                                    handleCostEdit('materialCost', e.target.value);
                                                    setEditingCost(null);
                                                },
                                                onKeyDown: (e) => {
                                                    if (e.key === 'Enter') {
                                                        handleCostEdit('materialCost', e.target.value);
                                                        setEditingCost(null);
                                                    }
                                                },
                                                className: "text-lg font-bold text-blue-600 bg-white border border-blue-300 rounded px-1 w-full",
                                                autoFocus: true
                                            }) :
                                            React.createElement('div', {
                                                className: `text-lg font-bold text-blue-600 cursor-pointer hover:bg-blue-100 rounded px-1 ${manualOverrides.materialCost !== null ? 'bg-blue-200' : ''}`,
                                                onClick: () => setEditingCost('materialCost')
                                            }, `R${calculateMaterialCost().toFixed(2)}`)
                                    ),

                                    React.createElement('div', { className: "bg-green-50 rounded-lg p-3" },
                                        React.createElement('h3', { className: "font-semibold text-green-800 mb-1 flex items-center justify-between" },
                                            "Labour",
                                            manualOverrides.laborCost !== null && React.createElement('button', {
                                                onClick: () => resetCostOverride('laborCost'),
                                                className: "text-xs text-red-600 hover:text-red-800"
                                            }, "Reset")
                                        ),
                                        editingCost === 'laborCost' ? 
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.01",
                                                defaultValue: calculateLaborCost().toFixed(2),
                                                onBlur: (e) => {
                                                    handleCostEdit('laborCost', e.target.value);
                                                    setEditingCost(null);
                                                },
                                                onKeyDown: (e) => {
                                                    if (e.key === 'Enter') {
                                                        handleCostEdit('laborCost', e.target.value);
                                                        setEditingCost(null);
                                                    }
                                                },
                                                className: "text-lg font-bold text-green-600 bg-white border border-green-300 rounded px-1 w-full",
                                                autoFocus: true
                                            }) :
                                            React.createElement('div', {
                                                className: `text-lg font-bold text-green-600 cursor-pointer hover:bg-green-100 rounded px-1 ${manualOverrides.laborCost !== null ? 'bg-green-200' : ''}`,
                                                onClick: () => setEditingCost('laborCost')
                                            }, `R${calculateLaborCost().toFixed(2)}`)
                                    ),

                                    React.createElement('div', { className: "bg-yellow-50 rounded-lg p-3" },
                                        React.createElement('h3', { className: "font-semibold text-yellow-800 mb-1 flex items-center justify-between" },
                                            "Operational",
                                            manualOverrides.operationalCost !== null && React.createElement('button', {
                                                onClick: () => resetCostOverride('operationalCost'),
                                                className: "text-xs text-red-600 hover:text-red-800"
                                            }, "Reset")
                                        ),
                                        editingCost === 'operationalCost' ? 
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.01",
                                                defaultValue: calculateTotalOperationalCost().toFixed(2),
                                                onBlur: (e) => {
                                                    handleCostEdit('operationalCost', e.target.value);
                                                    setEditingCost(null);
                                                },
                                                onKeyDown: (e) => {
                                                    if (e.key === 'Enter') {
                                                        handleCostEdit('operationalCost', e.target.value);
                                                        setEditingCost(null);
                                                    }
                                                },
                                                className: "text-lg font-bold text-yellow-600 bg-white border border-yellow-300 rounded px-1 w-full",
                                                autoFocus: true
                                            }) :
                                            React.createElement('div', {
                                                className: `text-lg font-bold text-yellow-600 cursor-pointer hover:bg-yellow-100 rounded px-1 ${manualOverrides.operationalCost !== null ? 'bg-yellow-200' : ''}`,
                                                onClick: () => setEditingCost('operationalCost')
                                            }, `R${calculateTotalOperationalCost().toFixed(2)}`)
                                    ),

                                    React.createElement('div', { className: "bg-purple-50 rounded-lg p-3" },
                                        React.createElement('h3', { className: "font-semibold text-purple-800 mb-1 flex items-center justify-between" },
                                            "Profit",
                                            manualOverrides.profit !== null && React.createElement('button', {
                                                onClick: () => resetCostOverride('profit'),
                                                className: "text-xs text-red-600 hover:text-red-800"
                                            }, "Reset")
                                        ),
                                        editingCost === 'profit' ? 
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.01",
                                                defaultValue: calculateProfit().toFixed(2),
                                                onBlur: (e) => {
                                                    handleCostEdit('profit', e.target.value);
                                                    setEditingCost(null);
                                                },
                                                onKeyDown: (e) => {
                                                    if (e.key === 'Enter') {
                                                        handleCostEdit('profit', e.target.value);
                                                        setEditingCost(null);
                                                    }
                                                },
                                                className: "text-lg font-bold text-purple-600 bg-white border border-purple-300 rounded px-1 w-full",
                                                autoFocus: true
                                            }) :
                                            React.createElement('div', {
                                                className: `text-lg font-bold text-purple-600 cursor-pointer hover:bg-purple-100 rounded px-1 ${manualOverrides.profit !== null ? 'bg-purple-200' : ''}`,
                                                onClick: () => setEditingCost('profit')
                                            }, `R${calculateProfit().toFixed(2)}`)
                                    )
                                ),

                                React.createElement('div', { className: "bg-indigo-100 rounded-lg p-4 mt-4 border-2 border-indigo-300" },
                                    React.createElement('h3', { className: "font-semibold text-indigo-800 mb-2 flex items-center justify-between" },
                                        "Final Selling Price",
                                        React.createElement('div', { className: "flex gap-2" },
                                            manualOverrides.finalPrice !== null && React.createElement('button', {
                                                onClick: () => resetCostOverride('finalPrice'),
                                                className: "text-xs text-red-600 hover:text-red-800"
                                            }, "Reset"),
                                            Object.values(manualOverrides).some(v => v !== null) && React.createElement('button', {
                                                onClick: resetAllOverrides,
                                                className: "text-xs text-gray-600 hover:text-gray-800"
                                            }, "Reset All")
                                        )
                                    ),
                                    editingCost === 'finalPrice' ? 
                                        React.createElement('input', {
                                            type: "number",
                                            step: "0.01",
                                            defaultValue: calculateFinalPrice().toFixed(2),
                                            onBlur: (e) => {
                                                handleCostEdit('finalPrice', e.target.value);
                                                setEditingCost(null);
                                            },
                                            onKeyDown: (e) => {
                                                if (e.key === 'Enter') {
                                                    handleCostEdit('finalPrice', e.target.value);
                                                    setEditingCost(null);
                                                }
                                            },
                                            className: "text-2xl font-bold text-indigo-700 bg-white border border-indigo-300 rounded px-1 w-full",
                                            autoFocus: true
                                        }) :
                                        React.createElement('div', {
                                            className: `text-2xl font-bold text-indigo-700 cursor-pointer hover:bg-indigo-200 rounded px-1 ${manualOverrides.finalPrice !== null ? 'bg-indigo-200' : ''}`,
                                            onClick: () => setEditingCost('finalPrice')
                                        }, `R${calculateFinalPrice().toFixed(2)}`)
                                )
                            ),

                            // Calculator Inputs
                            React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-4" },
                                React.createElement('h2', { className: "text-xl font-semibold mb-4 text-gray-800 flex items-center gap-2" },
                                    React.createElement(Package, { className: "text-green-600" }),
                                    editingProduct ? `Editing: ${editingProduct.name}` : "Settings"
                                ),

                                // Product Name
                                React.createElement('div', { className: "mb-4" },
                                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Product Name"),
                                    React.createElement('input', {
                                        type: "text",
                                        value: productName,
                                        onChange: (e) => setProductName(e.target.value),
                                        className: `w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 ${editingProduct ? 'bg-blue-50 border-blue-300' : ''}`,
                                        placeholder: "Enter product name"
                                    })
                                ),

                                // Basic inputs
                                React.createElement('div', { className: "space-y-3" },
                                    React.createElement('div', null,
                                        React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Material"),
                                        React.createElement('select', {
                                            value: filamentType,
                                            onChange: (e) => setFilamentType(e.target.value),
                                            className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                        }, 
                                            Object.entries(filamentTypes).map(([key, value]) =>
                                                React.createElement('option', { key: key, value: key }, key)
                                            )
                                        )
                                    ),

                                    React.createElement('div', { className: "grid grid-cols-2 gap-3" },
                                        React.createElement('div', null,
                                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Length (m)"),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.1",
                                                value: filamentLength,
                                                onChange: (e) => setFilamentLength(parseFloat(e.target.value) || 0),
                                                className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                            })
                                        ),

                                        React.createElement('div', null,
                                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Time (hours)"),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.1",
                                                value: printTime,
                                                onChange: (e) => setPrintTime(parseFloat(e.target.value) || 0),
                                                className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                            })
                                        )
                                    ),

                                    React.createElement('div', { className: "grid grid-cols-2 gap-3" },
                                        React.createElement('div', null,
                                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Filament Price (R)"),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.01",
                                                value: filamentPrice,
                                                onChange: (e) => setFilamentPrice(parseFloat(e.target.value) || 0),
                                                className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                            })
                                        ),

                                        React.createElement('div', null,
                                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Hourly Rate (R)"),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.01",
                                                value: hourlyRate,
                                                onChange: (e) => setHourlyRate(parseFloat(e.target.value) || 0),
                                                className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                            })
                                        )
                                    )
                                ),

                                // Action Buttons
                                React.createElement('div', { className: "flex gap-3 mt-4" },
                                    React.createElement('button', {
                                        onClick: saveProduct,
                                        disabled: !productName.trim(),
                                        className: "flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2 font-medium"
                                    },
                                        React.createElement(Save, { size: 16 }),
                                        editingProduct ? 'Update' : 'Save'
                                    ),
                                    
                                    React.createElement('button', {
                                        onClick: clearCalculator,
                                        className: "bg-gray-500 text-white py-3 px-4 rounded-lg hover:bg-gray-600 flex items-center justify-center"
                                    }, "Clear")
                                )
                            )
                        ) :
                        // Mobile Products View
                        React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-4" },
                            React.createElement('div', { className: "flex justify-between items-center mb-4" },
                                React.createElement('h2', { className: "text-xl font-semibold text-gray-800" }, "Products")
                            ),
                            
                            products.length === 0 ? 
                                React.createElement('p', { className: "text-gray-500 text-center py-8" }, "No products saved yet") :
                                React.createElement('div', { className: "space-y-3" },
                                    products.map((product) =>
                                        React.createElement('div', { key: product.id, className: "border border-gray-200 rounded-lg p-3" },
                                            React.createElement('div', { className: "flex justify-between items-start mb-2" },
                                                React.createElement('h3', { className: "font-semibold text-gray-800" }, product.name),
                                                React.createElement('div', { className: "flex gap-2" },
                                                    React.createElement('button', {
                                                        onClick: () => editProduct(product),
                                                        className: "text-blue-600 hover:text-blue-800 p-1"
                                                    }, ""),
                                                    React.createElement('button', {
                                                        onClick: () => deleteProduct(product.id),
                                                        className: "text-red-600 hover:text-red-800 p-1"
                                                    }, "")
                                                )
                                            ),
                                            
                                            React.createElement('div', { className: "grid grid-cols-2 gap-2 text-sm" },
                                                React.createElement('div', null,
                                                    React.createElement('span', { className: "text-gray-600" }, "Material:"),
                                                    React.createElement('span', { className: "ml-2 font-medium" }, product.filamentType)
                                                ),
                                                React.createElement('div', null,
                                                    React.createElement('span', { className: "text-gray-600" }, "Time:"),
                                                    React.createElement('span', { className: "ml-2 font-medium" }, `${product.printTime}h`)
                                                ),
                                                React.createElement('div', null,
                                                    React.createElement('span', { className: "text-gray-600" }, "Cost:"),
                                                    React.createElement('span', { className: "ml-2 font-medium" }, `R${(product.materialCost + product.laborCost + product.operationalCost).toFixed(2)}`)
                                                ),
                                                React.createElement('div', null,
                                                    React.createElement('span', { className: "text-gray-600" }, "Price:"),
                                                    React.createElement('span', { className: "ml-2 font-bold text-green-600" }, `R${product.finalPrice.toFixed(2)}`)
                                                )
                                            )
                                        )
                                    )
                                )
                        )
                )
            );
        };

        ReactDOM.render(React.createElement(CostCalculator), document.getElementById('root'));
    </script>
</body>
</html>

            // PWA Setup
            useEffect(() => {
                try {
                    if (window.matchMedia && window.matchMedia('(display-mode: standalone)').matches) {
                        console.log('App is running in standalone mode');
                    }

                    const handleBeforeInstallPrompt = (e) => {
                        e.preventDefault();
                        setDeferredPrompt(e);
                        setShowInstallButton(true);
                    };

                    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

                    if ('serviceWorker' in navigator) {
                        const swScript = `
                            const CACHE_NAME = '3d-print-calc-v1';
                            
                            self.addEventListener('install', (event) => {
                                console.log('Service Worker installing');
                                self.skipWaiting();
                            });

                            self.addEventListener('activate', (event) => {
                                console.log('Service Worker activated');
                                event.waitUntil(self.clients.claim());
                            });

                            self.addEventListener('fetch', (event) => {
                                if (event.request.method === 'GET') {
                                    event.respondWith(
                                        caches.match(event.request)
                                            .then((response) => {
                                                if (response) {
                                                    return response;
                                                }
                                                return fetch(event.request).catch(() => {
                                                    if (event.request.mode === 'navigate') {
                                                        return new Response('<h1>App works offline</h1><p>Your 3D Print Calculator is available offline!</p>', {
                                                            headers: { 'Content-Type': 'text/html' }
                                                        });
                                                    }
                                                });
                                            })
                                    );
                                }
                            });
                        `;

                        const blob = new Blob([swScript], { type: 'application/javascript' });
                        const swUrl = URL.createObjectURL(blob);
                        
                        navigator.serviceWorker.register(swUrl)
                            .then((registration) => {
                                console.log('ServiceWorker registration successful');
                            })
                            .catch((error) => {
                                console.log('ServiceWorker registration failed:', error);
                            });
                    }

                    return () => {
                        window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
                    };
                } catch (error) {
                    console.log('PWA setup error:', error);
                }
            }, []);

            // Load products from localStorage with error handling
            useEffect(() => {
                try {
                    const savedProducts = localStorage?.getItem('3d_printing_products');
                    if (savedProducts && savedProducts !== 'null') {
                        const parsedProducts = JSON.parse(savedProducts);
                        if (Array.isArray(parsedProducts)) {
                            setProducts(parsedProducts);
                        }
                    }
                } catch (error) {
                    console.log('Error loading products:', error);
                    setProducts([]);
                }
            }, []);

            // Save products to localStorage with error handling
            useEffect(() => {
                try {
                    if (typeof Storage !== 'undefined' && localStorage) {
                        localStorage.setItem('3d_printing_products', JSON.stringify(products));
                    }
                } catch (error) {
                    console.log('Error saving products:', error);
                }
            }, [products]);

            // PWA Install function
            const handleInstallClick = async () => {
                if (deferredPrompt) {
                    try {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;
                        console.log(`User response to the install prompt: ${outcome}`);
                        setDeferredPrompt(null);
                        setShowInstallButton(false);
                    } catch (error) {
                        console.log('Install prompt error:', error);
                        setShowInstallButton(false);
                    }
                }
            };

            // Calculate costs with error handling
            const getCurrentDensity = () => {
                try {
                    return filamentType === 'CUSTOM' ? customDensity : filamentTypes[filamentType]?.density || 1.20;
                } catch (error) {
                    console.log('Error getting density:', error);
                    return 1.20;
                }
            };

            const calculateVolume = () => {
                try {
                    const radius = (filamentDiameter || 1.75) / 2;
                    const length = filamentLength || 0;
                    return Math.PI * Math.pow(radius, 2) * length / 1000;
                } catch (error) {
                    console.log('Error calculating volume:', error);
                    return 0;
                }
            };

            const calculateMaterialCost = () => {
                try {
                    const density = getCurrentDensity();
                    const volume = calculateVolume();
                    const mass = (volume * density) / 1000;
                    const pricePerKg = (filamentPrice || 0) / (filamentWeight || 1);
                    return mass * pricePerKg;
                } catch (error) {
                    console.log('Error calculating material cost:', error);
                    return 0;
                }
            };

            const calculatePowerCost = () => {
                try {
                    const powerConsumptionKwh = ((printerPower || 0) / 1000) * (printTime || 0);
                    return powerConsumptionKwh * (electricityRate || 0);
                } catch (error) {
                    console.log('Error calculating power cost:', error);
                    return 0;
                }
            };

            const calculateMaintenanceCost = () => {
                try {
                    return (printTime || 0) * (maintenanceCostPerHour || 0);
                } catch (error) {
                    console.log('Error calculating maintenance cost:', error);
                    return 0;
                }
            };

            const calculateLaborCost = () => {
                try {
                    return (printTime || 0) * (hourlyRate || 0);
                } catch (error) {
                    console.log('Error calculating labor cost:', error);
                    return 0;
                }
            };

            const calculateTotalOperationalCost = () => {
                try {
                    return calculatePowerCost() + calculateMaintenanceCost();
                } catch (error) {
                    console.log('Error calculating operational cost:', error);
                    return 0;
                }
            };

            const calculateSubtotal = () => {
                try {
                    return calculateMaterialCost() + calculateLaborCost() + calculateTotalOperationalCost();
                } catch (error) {
                    console.log('Error calculating subtotal:', error);
                    return 0;
                }
            };

            const calculateFinalPrice = () => {
                try {
                    const subtotal = calculateSubtotal();
                    return subtotal * (1 + (markup || 0) / 100);
                } catch (error) {
                    console.log('Error calculating final price:', error);
                    return 0;
                }
            };

            const calculateProfit = () => {
                try {
                    return calculateFinalPrice() - calculateSubtotal();
                } catch (error) {
                    console.log('Error calculating profit:', error);
                    return 0;
                }
            };

            // Product management functions with error handling
            const saveProduct = () => {
                try {
                    if (!productName.trim()) return;

                    const productData = {
                        id: editingProduct ? editingProduct.id : Date.now(),
                        name: productName,
                        filamentType,
                        customDensity,
                        filamentDiameter,
                        filamentLength,
                        filamentPrice,
                        filamentWeight,
                        printTime,
                        hourlyRate,
                        markup,
                        printerPower,
                        electricityRate,
                        maintenanceCostPerHour,
                        materialCost: calculateMaterialCost(),
                        laborCost: calculateLaborCost(),
                        operationalCost: calculateTotalOperationalCost(),
                        finalPrice: calculateFinalPrice(),
                        profit: calculateProfit(),
                        createdAt: editingProduct ? editingProduct.createdAt : new Date().toISOString()
                    };

                    if (editingProduct) {
                        setProducts(products.map(p => p.id === editingProduct.id ? productData : p));
                        setEditingProduct(null);
                    } else {
                        setProducts([...products, productData]);
                    }

                    setProductName('');
                    setShowMobileMenu(false);
                } catch (error) {
                    console.log('Error saving product:', error);
                    alert('Error saving product. Please try again.');
                }
            };

            const clearCalculator = () => {
                setEditingProduct(null);
                setProductName('');
                setFilamentType('PLA');
                setCustomDensity(1.20);
                setFilamentDiameter(1.75);
                setFilamentLength(10);
                setFilamentPrice(450);
                setFilamentWeight(1);
                setPrintTime(2);
                setHourlyRate(250);
                setMarkup(50);
                setPrinterPower(250);
                setElectricityRate(3.50);
                setMaintenanceCostPerHour(8.50);
            };

            return React.createElement('div', { className: "max-w-7xl mx-auto p-2 md:p-6 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen" },
                // PWA Install Banner
                showInstallButton && React.createElement('div', { className: "bg-blue-600 text-white p-4 rounded-lg mb-4 flex items-center justify-between" },
                    React.createElement('div', { className: "flex items-center gap-3" },
                        React.createElement(Smartphone),
                        React.createElement('div', null,
                            React.createElement('h3', { className: "font-semibold" }, "Install App"),
                            React.createElement('p', { className: "text-sm opacity-90" }, "Add to home screen for quick access")
                        )
                    ),
                    React.createElement('button', {
                        onClick: handleInstallClick,
                        className: "bg-white text-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100"
                    }, "Install")
                ),

                // Header
                React.createElement('div', { className: "mb-6 text-center" },
                    React.createElement('h1', { className: "text-2xl md:text-4xl font-bold text-gray-800 mb-2 flex items-center justify-center gap-3" },
                        React.createElement(Calculator, { className: "text-blue-600" }),
                        "3D Print Calculator"
                    ),
                    React.createElement('p', { className: "text-gray-600 text-sm md:text-base" }, "Calculate costs and manage your 3D printing business")
                ),

                // Mobile Layout
                React.createElement('div', { className: "block lg:hidden" },
                    // Mobile Navigation
                    React.createElement('div', { className: "bg-white rounded-lg shadow-lg mb-4" },
                        React.createElement('div', { className: "flex border-b" },
                            React.createElement('button', {
                                onClick: () => setShowMobileMenu(false),
                                className: `flex-1 py-3 px-4 text-center font-medium ${!showMobileMenu ? 'bg-blue-600 text-white' : 'text-gray-600'}`
                            }, "Calculator"),
                            React.createElement('button', {
                                onClick: () => setShowMobileMenu(true),
                                className: `flex-1 py-3 px-4 text-center font-medium ${showMobileMenu ? 'bg-blue-600 text-white' : 'text-gray-600'}`
                            }, `Products (${products.length})`)
                        )
                    ),

                    !showMobileMenu ? 
                        // Mobile Calculator View
                        React.createElement('div', { className: "space-y-4" },
                            // Cost Breakdown - Mobile First
                            React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-4" },
                                React.createElement('h2', { className: "text-xl font-semibold mb-4 text-gray-800 flex items-center gap-2" },
                                    React.createElement(DollarSign, { className: "text-green-600" }),
                                    "Cost Breakdown"
                                ),

                                React.createElement('div', { className: "grid grid-cols-2 gap-3 text-sm" },
                                    React.createElement('div', { className: "bg-blue-50 rounded-lg p-3" },
                                        React.createElement('h3', { className: "font-semibold text-blue-800 mb-1" }, "Material"),
                                        React.createElement('div', { className: "text-lg font-bold text-blue-600" }, `R${calculateMaterialCost().toFixed(2)}`)
                                    ),

                                    React.createElement('div', { className: "bg-green-50 rounded-lg p-3" },
                                        React.createElement('h3', { className: "font-semibold text-green-800 mb-1" }, "Labour"),
                                        React.createElement('div', { className: "text-lg font-bold text-green-600" }, `R${calculateLaborCost().toFixed(2)}`)
                                    ),

                                    React.createElement('div', { className: "bg-yellow-50 rounded-lg p-3" },
                                        React.createElement('h3', { className: "font-semibold text-yellow-800 mb-1" }, "Operational"),
                                        React.createElement('div', { className: "text-lg font-bold text-yellow-600" }, `R${calculateTotalOperationalCost().toFixed(2)}`)
                                    ),

                                    React.createElement('div', { className: "bg-purple-50 rounded-lg p-3" },
                                        React.createElement('h3', { className: "font-semibold text-purple-800 mb-1" }, "Profit"),
                                        React.createElement('div', { className: "text-lg font-bold text-purple-600" }, `R${calculateProfit().toFixed(2)}`)
                                    )
                                ),

                                React.createElement('div', { className: "bg-indigo-100 rounded-lg p-4 mt-4 border-2 border-indigo-300" },
                                    React.createElement('h3', { className: "font-semibold text-indigo-800 mb-2" }, "Final Selling Price"),
                                    React.createElement('div', { className: "text-2xl font-bold text-indigo-700" }, `R${calculateFinalPrice().toFixed(2)}`)
                                )
                            ),

                            // Calculator Inputs
                            React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-4" },
                                React.createElement('h2', { className: "text-xl font-semibold mb-4 text-gray-800 flex items-center gap-2" },
                                    React.createElement(Package, { className: "text-green-600" }),
                                    editingProduct ? `Editing: ${editingProduct.name}` : "Settings"
                                ),

                                // Product Name
                                React.createElement('div', { className: "mb-4" },
                                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Product Name"),
                                    React.createElement('input', {
                                        type: "text",
                                        value: productName,
                                        onChange: (e) => setProductName(e.target.value),
                                        className: `w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 ${editingProduct ? 'bg-blue-50 border-blue-300' : ''}`,
                                        placeholder: "Enter product name"
                                    })
                                ),

                                // Basic inputs
                                React.createElement('div', { className: "space-y-3" },
                                    React.createElement('div', null,
                                        React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Material"),
                                        React.createElement('select', {
                                            value: filamentType,
                                            onChange: (e) => setFilamentType(e.target.value),
                                            className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                        }, 
                                            Object.entries(filamentTypes).map(([key, value]) =>
                                                React.createElement('option', { key: key, value: key }, key)
                                            )
                                        )
                                    ),

                                    React.createElement('div', { className: "grid grid-cols-2 gap-3" },
                                        React.createElement('div', null,
                                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Length (m)"),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.1",
                                                value: filamentLength,
                                                onChange: (e) => setFilamentLength(parseFloat(e.target.value) || 0),
                                                className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                            })
                                        ),

                                        React.createElement('div', null,
                                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Time (hours)"),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.1",
                                                value: printTime,
                                                onChange: (e) => setPrintTime(parseFloat(e.target.value) || 0),
                                                className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                            })
                                        )
                                    ),

                                    React.createElement('div', { className: "grid grid-cols-2 gap-3" },
                                        React.createElement('div', null,
                                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Filament Price (R)"),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.01",
                                                value: filamentPrice,
                                                onChange: (e) => setFilamentPrice(parseFloat(e.target.value) || 0),
                                                className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                            })
                                        ),

                                        React.createElement('div', null,
                                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-1" }, "Hourly Rate (R)"),
                                            React.createElement('input', {
                                                type: "number",
                                                step: "0.01",
                                                value: hourlyRate,
                                                onChange: (e) => setHourlyRate(parseFloat(e.target.value) || 0),
                                                className: "w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                            })
                                        )
                                    )
                                ),

                                // Action Buttons
                                React.createElement('div', { className: "flex gap-3 mt-4" },
                                    React.createElement('button', {
                                        onClick: saveProduct,
                                        disabled: !productName.trim(),
                                        className: "flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2 font-medium"
                                    },
                                        React.createElement(Save, { size: 16 }),
                                        editingProduct ? 'Update' : 'Save'
                                    ),
                                    
                                    React.createElement('button', {
                                        onClick: clearCalculator,
                                        className: "bg-gray-500 text-white py-3 px-4 rounded-lg hover:bg-gray-600 flex items-center justify-center"
                                    }, "Clear")
                                )
                            )
                        ) :
                        // Mobile Products View
                        React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-4" },
                            React.createElement('div', { className: "flex justify-between items-center mb-4" },
                                React.createElement('h2', { className: "text-xl font-semibold text-gray-800" }, "Products")
                            ),
                            
                            products.length === 0 ? 
                                React.createElement('p', { className: "text-gray-500 text-center py-8" }, "No products saved yet") :
                                React.createElement('div', { className: "space-y-3" },
                                    products.map((product) =>
                                        React.createElement('div', { key: product.id, className: "border border-gray-200 rounded-lg p-3" },
                                            React.createElement('div', { className: "flex justify-between items-start mb-2" },
                                                React.createElement('h3', { className: "font-semibold text-gray-800" }, product.name),
                                                React.createElement('div', { className: "flex gap-2" },
                                                    React.createElement('button', {
                                                        onClick: () => editProduct(product),
                                                        className: "text-blue-600 hover:text-blue-800 p-1"
                                                    }, ""),
                                                    React.createElement('button', {
                                                        onClick: () => deleteProduct(product.id),
                                                        className: "text-red-600 hover:text-red-800 p-1"
                                                    }, "")
                                                )
                                            ),
                                            
                                            React.createElement('div', { className: "grid grid-cols-2 gap-2 text-sm" },
                                                React.createElement('div', null,
                                                    React.createElement('span', { className: "text-gray-600" }, "Material:"),
                                                    React.createElement('span', { className: "ml-2 font-medium" }, product.filamentType)
                                                ),
                                                React.createElement('div', null,
                                                    React.createElement('span', { className: "text-gray-600" }, "Time:"),
                                                    React.createElement('span', { className: "ml-2 font-medium" }, `${product.printTime}h`)
                                                ),
                                                React.createElement('div', null,
                                                    React.createElement('span', { className: "text-gray-600" }, "Cost:"),
                                                    React.createElement('span', { className: "ml-2 font-medium" }, `R${(product.materialCost + product.laborCost + product.operationalCost).toFixed(2)}`)
                                                ),
                                                React.createElement('div', null,
                                                    React.createElement('span', { className: "text-gray-600" }, "Price:"),
                                                    React.createElement('span', { className: "ml-2 font-bold text-green-600" }, `R${product.finalPrice.toFixed(2)}`)
                                                )
                                            )
                                        )
                                    )
                                )
                        )
                )
            );
        };

        ReactDOM.render(React.createElement(CostCalculator), document.getElementById('root'));
    </script>
</body>
</html>
